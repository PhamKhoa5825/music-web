<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="tab-home" id="view-home" class="content-view">
    <div class="d-flex justify-content-between align-items-center mb-4 sticky-top py-3" style="background-color: rgba(5,5,5,0.95); z-index: 900; backdrop-filter: blur(10px);">
        <div class="position-relative" style="width: 400px;">
            <div class="input-group">
                <span class="input-group-text bg-dark border-secondary text-secondary rounded-start-pill ps-3"><i class="bi bi-search"></i></span>
                <input type="text" id="searchInput" class="form-control bg-dark border-secondary text-white rounded-end-pill"
                       placeholder="Tìm kiếm..." onkeyup="debounceSearch()">
            </div>
            <div id="searchResults" class="search-results-dropdown p-2"></div>
        </div>
        <div class="d-flex align-items-center gap-3">
            <div class="text-end lh-1">
                <small class="text-white-50" style="font-size: 0.7em">USER ID</small>
                <div class="fw-bold text-info" id="display-uid">--</div>
            </div>
            <img src="https://placehold.co/40" class="rounded-circle border border-secondary">
        </div>
    </div>

    <div class="mb-5">
        <h4 class="section-title">Gợi ý cho bạn</h4>
        <div id="loading-rec" class="text-center"><div class="spinner-border text-info"></div></div>
        <div class="row row-cols-2 row-cols-md-4 row-cols-lg-6 g-4" id="recommend-list"></div>
    </div>
    <div class="mb-5">
        <h4 class="section-title">Mới Phát Hành</h4>
        <div class="row g-3" id="new-release-list"></div>
    </div>
    <div class="mb-5">
        <h4 class="section-title text-warning">Top Trending</h4>
        <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-4" id="trending-list"></div>
    </div>
</div>

<div th:fragment="tab-ranking" id="view-ranking" class="content-view d-none">
    <div class="d-flex align-items-center justify-content-between mb-4 pt-3">
        <h2 class="mb-0 text-uppercase fw-bold text-info"><i class="bi bi-trophy-fill me-2"></i>Bảng Xếp Hạng</h2>
    </div>

    <div class="d-flex flex-wrap gap-3 mb-5 align-items-center bg-dark p-3 rounded border border-secondary">
        <div>
            <span class="text-muted me-2 small fw-bold">THỜI GIAN:</span>
            <div class="btn-group" role="group">
                <button type="button" class="btn btn-sm filter-btn active" onclick="changeRankMode('DAY')">Hôm nay</button>
                <button type="button" class="btn btn-sm filter-btn" onclick="changeRankMode('WEEK')">Tuần này</button>
                <button type="button" class="btn btn-sm filter-btn" onclick="changeRankMode('MONTH')">Tháng này</button>
            </div>
        </div>
    </div>
    <div id="ranking-list" class="d-flex flex-column gap-3"></div>
</div>

<div th:fragment="tab-playlist-detail" id="view-playlist-detail" class="content-view d-none">
    <div class="playlist-header mb-4" style="height: 300px; position: relative; overflow: hidden; border-radius: 8px;">
        <div id="pl-blur-bg" class="blur-bg" style="position: absolute; inset: 0; background-size: cover; filter: blur(20px) brightness(0.5);"></div>
        <div class="header-content d-flex align-items-end h-100 p-4" style="position: relative; z-index: 2; background: linear-gradient(to top, #121212, transparent);">
            <img id="pl-cover-img" src="" class="shadow rounded me-4" width="200" height="200" style="object-fit: cover;">
            <div>
                <span class="badge bg-primary mb-2">PLAYLIST</span>
                <h1 class="display-4 fw-bold mb-2" id="pl-name-detail">Loading...</h1>
                <p class="text-white-50" id="pl-desc-detail">...</p>
                <button class="btn btn-success rounded-pill px-4 fw-bold me-2" onclick="playWholePlaylist()"><i class="bi bi-play-fill"></i> Phát</button>
                <button class="btn btn-outline-light rounded-pill px-4" onclick="closePlaylistDetail()"><i class="bi bi-arrow-left"></i> Quay lại</button>
            </div>
        </div>
    </div>
    <div class="px-4">
        <table class="table table-borderless table-hover align-middle text-white">
            <thead class="text-secondary small border-bottom border-secondary"><tr><th>#</th><th>BÀI HÁT</th><th>NGHỆ SĨ</th><th>THỜI GIAN</th><th></th></tr></thead>
            <tbody id="pl-detail-songs-body"></tbody>
        </table>
    </div>
</div>

<div th:fragment="tab-foryou" id="view-foryou" class="content-view d-none">
    <div class="mb-5 pt-3">
        <h3 class="fw-bold mb-3">Daily Mix <span class="fs-6 text-white-50 fw-normal ms-2">Tuyển tập riêng</span></h3>
        <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-4" id="foryou-mix-list">
            <div class="col"><div class="spinner-border text-success"></div></div>
        </div>
    </div>
    <div class="mb-5">
        <h3 class="fw-bold mb-3">Xu hướng</h3>
        <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-4" id="foryou-trend-list"></div>
    </div>
    <div class="mb-5">
        <h3 class="fw-bold mb-3">Khám phá</h3>
        <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-4" id="foryou-discovery-list"></div>
    </div>
</div>

<div th:fragment="tab-liked" id="view-liked" class="content-view d-none">
    <div class="d-flex align-items-end gap-3 mb-4 p-4 rounded mt-3" style="background: linear-gradient(135deg, #292533, #716a77);">
        <i class="bi bi-heart-fill display-1 text-white shadow"></i>
        <div>
            <span class="text-white small fw-bold">PLAYLIST</span>
            <h1 class="display-4 fw-bold text-white mb-0">Bài Hát Đã Thích</h1>
            <div class="text-white-50 mt-2" id="liked-count-text">... bài hát</div>
        </div>
    </div>
    <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-4" id="liked-songs-grid"></div>
</div>

<div th:fragment="tab-history" id="view-history" class="content-view d-none">
    <div class="d-flex align-items-center gap-3 mb-4 pt-3">
        <i class="bi bi-clock-history text-warning fs-1"></i>
        <h3 class="fw-bold mb-0">Lịch sử nghe nhạc</h3>
        <span class="text-white-50 ms-2" id="history-count">(0)</span>
    </div>
    <table class="table table-dark table-hover bg-transparent align-middle">
        <tbody id="history-body"></tbody>
    </table>
</div>

<div th:fragment="tab-playlists" id="view-playlists" class="content-view d-none">
    <div class="d-flex align-items-end justify-content-between mb-4 pt-3">
        <div>
            <h3 class="fw-bold mb-0">Playlist của bạn</h3>
            <span class="text-white-50 small" id="playlist-total-count">0 tuyển tập</span>
        </div>
        <button class="btn btn-outline-light rounded-pill px-4 fw-bold" onclick="openCreateModal()">
            <i class="bi bi-plus-lg me-2"></i>Tạo mới
        </button>
    </div>
    <div class="row row-cols-2 row-cols-md-4 row-cols-lg-5 g-4" id="user-playlists-grid"></div>
</div>

</body>
</html>